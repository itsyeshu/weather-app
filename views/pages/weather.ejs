<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../partials/head', {
            title : `${data.city_name}, ${data.city.country_code} • ${data.current.weather.desc}`,
            favicon : "/public/img/favicon.png",
            og_img : `https://openweathermap.org/img/wn/${data.current.weather.icon}@2x.png`,
            desc : `${data.city_name} is a beautiful city to live and ${data.current.weather.desc} weather makes it worth visiting it.`
    }); %>
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
</head>
<body class="container">
    <%- include('../partials/header', {
        show_back_button: true,
        back_button_link: '/search',
    }); %>
    <main id="app">
        <div id="container" class="flex">
            <div id="background">
                <div class="bg-img-cont"></div>
            </div>
            <div id="content">
                <div id="city_weather">
                    <div class="box invert">
                        <div class="box_container hvr">
                            <div class="city_box flex box_content">
                                <div class="city_name_box flex_grow">
                                    <h2>
                                        <%= data.city_name %>
                                        <span class="country_code"><img src="https://open-meteo.com/images/country-flags/<%= data.city.country_code.toLowerCase() %>.svg" alt="<%= data.city.country_code %>" title="<%= data.city.state %>, <%= data.city.country %>"></span>
                                        <% if(data.id == 1261977){ %>
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" fill="#1da1f2" height="20" style="display:inline-block;fill: #CFD8DC;margin-bottom: -2px;" hvr="Hometown">
                                                <path xmlns="http://www.w3.org/2000/svg" d="M21 4H7V2H5v20h2v-8h14l-2-5 2-5zm-6 5c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2z"/>
                                            </svg>
                                        <% } %>
                                    </h2>
                                    <p class="simpl_p"><%= data.lat %>, <%= data.lon %> &bullet; <%= data.city.state %>, <%= data.city.country_code %></p>
                                </div>
                                <a href="/" class="simpl_btn btn_sq btn_48" hvr="Search"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g xmlns="http://www.w3.org/2000/svg"><path d="M22,20.59l-4.69-4.69C18.37,14.55,19,12.85,19,11c0-4.42-3.58-8-8-8c-4.08,0-7.44,3.05-7.93,7h2.02C5.57,7.17,8.03,5,11,5 c3.31,0,6,2.69,6,6s-2.69,6-6,6c-2.42,0-4.5-1.44-5.45-3.5H3.4C4.45,16.69,7.46,19,11,19c1.85,0,3.55-0.63,4.9-1.69L20.59,22 L22,20.59z"/><polygon points="8.43,9.69 9.65,15 11.29,15 12.55,11.22 13.5,13.5 15.5,13.5 15.5,12 14.5,12 13.25,9 11.71,9 10.59,12.37 9.35,7 7.7,7 6.45,11 1,11 1,12.5 7.55,12.5"/></g></svg></a>
                            </div>
                        </div>
                        <% if(data.city_count > 1){ %>
                        <hr class="hr_90">
                        <div class="box_container" style=" padding-top:18px;overflow:hidden;border-radius: 0 0 var(--border-radius-for-box, 12px) var(--border-radius-for-box, 12px);">
                            <div class="tags scroll-y flex">
                                <span style="white-space: nowrap;margin-right:12px;">Results :</span>
                                <% for( let index = 1; index <= data.city_count; index++ ) { %>
                                    <% if (index == data.counter) { %>
                                        <div class="tag special_link" selected="">
                                            <b>
                                                <%= index %>
                                                <span class="country_code"><img src="https://open-meteo.com/images/country-flags/<%= data.city_countries[index-1].toLowerCase() %>.svg" alt="<%= data.city_countries[index-1] %>"></span>
                                            </b>
                                        </div>
                                    <% } else { %>
                                        <a href="/search/?city=<%= data.query_city_name %>&counter=<%= index %>" class="tag special_link">
                                            <b>
                                                <%= index %>
                                                <span class="country_code"><img src="https://open-meteo.com/images/country-flags/<%= data.city_countries[index-1].toLowerCase() %>.svg" alt="<%= data.city_countries[index-1] %>"></span>
                                            </b>
                                        </a>
                                    <% } %>
                                <% } %>
                            </div>
                        </div>
                        <% } %>
                    </div>
                    <div class="box transparent_box" style="overflow:visible;">
                        <div class="box_content flex">
                            <div class="temperature_box flex">
                                <div class="main_temp">
                                <h1><%= data.current.temperature %></h1>
                                </div>
                                <div class="main_temp_scales">
                                    <div class="main_temp_overlay"></div>
                                    <div class="main_temp_scale"><%= data.current.temperature_unit %></div>
                                    <div class="main_temp_scale "><%= data.current.weather.desc %></div>
                                </div>
                            </div>
                            <div class="weather_icon" title="<%= data.current.weather.desc %>">
                                <img src="https://openweathermap.org/img/wn/<%= data.current.weather.icon %>@2x.png" alt="<%= data.current.weather.desc %>">
                            </div>
                        </div>
                        <div class="box_content" style="margin-top:-12px;">
                            <p class="simpl_p">
                                <%= data.current.temperature_min %> / <%= data.current.temperature_max %><%= data.current.temperature_unit %> &bullet; Feels like <%= data.current.apparent_temperature %><%= data.current.temperature_unit %>
                            </p>
                        </div>
                        <div class="flex">
                            <button class="simpl_btn btn_sq btn_opt hvr" id="gps_button" hvr="GPS">
                                <svg xmlns="http://www.w3.org/2000/svg" height="22px" viewBox="0 0 24 24" width="22px" style="padding:1px;"><path xmlns="http://www.w3.org/2000/svg" d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"/></svg>
                            </button>
                            <button class="simpl_btn btn_sq btn_opt hvr" id="toggle_theme_button" hvr="Toggle dark theme">
                                <svg xmlns="http://www.w3.org/2000/svg" height="22px" viewBox="0 0 24 24" width="22px" style="padding:1px;"><path xmlns="http://www.w3.org/2000/svg" d="M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36c-0.98,1.37-2.58,2.26-4.4,2.26 c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg>
                            </button>
                            <button class="simpl_btn btn_sq btn_opt hvr" id="refresh_button" hvr="Refresh data">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path xmlns="http://www.w3.org/2000/svg" d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
                            </button>
                            <a class="simpl_btn btn_sq btn_opt hvr" href="https://github.com/itsyeshu/weather-app/" target="_blank" hvr="Embed iframe">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path xmlns="http://www.w3.org/2000/svg" d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/></svg>
                            </a>
                        </div>
                    </div>
                    <div class="box transparent_box">
                        <div class="box_content">
                            <div class="small_boxes flex">
                                <div class="small_box">
                                    <div class="box_content">
                                        <p class="light_opacity">
                                            Wind speed
                                        </p>
                                        <p style="font-size:15px;line-height: 18px;margin-top:-6px;">
                                            <%= data.current.others.wind_speed %> <%= data.current.others.wind_speed_unit %> &bull; <%= data.current.others.wind_direction %><%= data.current.others.wind_direction_unit %> <span class="svg-inline" style="transform-origin: center;transform: rotate(<%= data.current.others.wind_direction %>deg);width:16px;height:16px;margin-right:-4px;"><svg xmlns="http://www.w3.org/2000/svg" height="16" viewBox="0 96 960 960" width="16" fill="currentColor"><path d="m223.5 901-21-21 278-673 277 673-21 21-257-117-256 117Z"/></svg></span>
                                        </p>
                                    </div>
                                </div>
                                <div class="small_box">
                                    <div class="box_content">
                                        <p class="light_opacity">
                                            UV index
                                        </p>
                                        <p style="font-size:15px;line-height: 18px;margin-top:-6px;">
                                            <%= data.current.others.uv_index %> (<%= data.current.others.uv_index_safety %>)
                                        </p>
                                    </div>
                                </div>
                                <div class="small_box">
                                    <div class="box_content">
                                        <p class="light_opacity">
                                            Air quality index
                                        </p>
                                        <p style="font-size:15px;line-height: 18px;margin-top:-6px;">
                                            <%= data.current.others.air_quality %> (<%= data.current.others.air_quality_safety %>)
                                        </p>
                                    </div>
                                </div>
                                <div class="small_box">
                                    <div class="box_content">
                                        <p class="light_opacity">
                                            Data provided by
                                        </p>
                                        <p style="font-size:15px;line-height: 18px;margin-top:-6px;">
                                            <a class="special_link" href="https://open-meteo.com/" target="_blank">Open-meteo <span class="svg-inline"><svg xmlns="http://www.w3.org/2000/svg" height="16" viewBox="0 96 960 960" width="16" fill="currentColor"><path d="M220 903q-27.637 0-47.319-19.681Q153 863.638 153 836V316q0-27.638 19.681-47.319Q192.363 249 220 249h257v67H220v520h520V579h67v257q0 27.638-19.681 47.319T740 903H220Zm168.5-188L341 667.5 692.5 316H568v-67h239v239h-67V363.5L388.5 715Z"/></svg></span></a>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box_border"></div>
                <div id="weather_forecast">
                    <div class="box">
                        <div class="box_content">
                            <p class="main_temp_scale light">
                                Hourly forecast
                            </p>
                            <div class="hourly_forecasts flex wide_scroll_box scroll-y">
                                <% for( let index = 0; index < 12; index++ ) { %>
                                    <% if (data.hourly.forecast.time[index] == "01 AM" && index != 0) { %>
                                        <div class="hourly_forecast">
                                            &bullet;
                                        </div>
                                        <div class="hourly_forecast" style="white-space: nowrap;">
                                            Tomorrow
                                        </div>
                                    <% } %>
                                    <div class="hourly_forecast">
                                        <div class="normal_text">
                                            <%= data.hourly.forecast.time[index] %>
                                        </div>
                                        <div class="weather_icon small round" title="<%= data.hourly.forecast.weathercode[index].desc %>">
                                            <img src="https://openweathermap.org/img/wn/<%= data.hourly.forecast.weathercode[index].icon %>@2x.png" alt="<%= data.hourly.forecast.weathercode[index].desc %>">
                                        </div>
                                        <div class="normal_text">
                                            <%= data.hourly.forecast.temperature_2m[index] %>
                                            <%= data.current.temperature_unit %>
                                        </div>
                                    </div>
                                <% } %>
                            </div>
                        </div>
                    </div>
                    <div class="box">
                        <div class="box_container">
                            <div class="box_content">
                                <p class="main_temp_scale light">Forecast</p>
                                <div class="daily_forecasts">
                                    <% for(var index=0; index < 7; index++) { %>
                                    
                                        <% if(index != 0){ %>
                                            <hr class="hr">
                                        <% } %>
                                        <div class="daily_forecast flex">
                                            <div class="weather_icon small round" title="<%= data.daily.forecast.weathercode[index].desc %>">
                                                <img src="https://openweathermap.org/img/wn/<%= data.daily.forecast.weathercode[index].icon %>@2x.png" alt="<%= data.daily.forecast.weathercode[index].desc %>">
                                            </div>
                                            <div class="daily_forecast_date">
                                                <div class="main_temp_scale">
                                                    <%= data.daily.forecast.day[index] %>
                                                </div>
                                                <div class="light_opacity">
                                                    <%= data.daily.forecast.time[index] %> &bullet; <%= data.daily.forecast.weathercode[index].desc %>
                                                </div>
                                            </div>
                                            <div class="text_align_rt">
                                                <div class="simpl_text">
                                                    <%= data.daily.forecast.temperature_2m_min[index] %> / <%= data.daily.forecast.temperature_2m_max[index] %>°C
                                                </div>
                                            </div>
                                        </div>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="dialog-container">
                <dialog id="gps_info_dialog" class="dialog">
                    <div class="dialog-sect dialog-title-sect">
                        <img src="/public/img/loading-transparent.gif" alt="" style="display:inline-block;width:34px;height:34px;vertical-align: middle;margin:0 0 -4px -8px;">
                        <div class="dialog-title">
                            Under development
                        </div>
                    </div>
                    <div class="dialog-sect dialog-body">
                        <p>Sorry for inconvenience, this functionality will be added shortly.</p>
                    </div>
                    <div class="dialog-sect dialog-footer">
                        <button class="simpl_btn btn" onclick="this.parentNode.parentNode.close();">Close</button>
                    </div>
                </dialog>
            </div>
        </div>
    </main>
    <script src="/public/js/script.js"></script>
</body>
</html>