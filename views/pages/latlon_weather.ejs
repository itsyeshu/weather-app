<!DOCTYPE html>
<html lang="en"
    <% if(data.current.dark_theme) { %> class="theme-dark" <% } %>
    >
<head>
    <%- include('../partials/head', {
            title : `Your location • ${data.current.weather.desc}`,
            favicon : "/public/img/favicon.png",
            og_img : `https://openweathermap.org/img/wn/${data.current.weather.icon}@2x.png`,
            desc : `Weather forecast for latitude ${data.lat} & longitude ${data.lon}`,
            dark_theme : data.current.dark_theme,
    }); %>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=&sensor=false"></script>
</head>
<body class="container">
    <%- include('../partials/header', {
        show_back_button: true,
        back_button_link: '/search',
    }); %>
    <main id="app">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="svg" style="display:none;">
            <defs>
                <path id="path_light_theme" xmlns="http://www.w3.org/2000/svg" d="M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"/>
                <path id="path_dark_theme" xmlns="http://www.w3.org/2000/svg" d="M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6z"/>
            </defs>
        </svg>
        <div id="container" class="flex">
            <div id="background">
                <div class="bg-img-cont"></div>
            </div>
            <div id="content">
                <div id="city_weather">
                    <div class="box invert">
                        <div class="box_container hvr">
                            <div class="city_box flex box_content">
                                <div class="city_name_box flex_grow">
                                    <h2>
                                        Your location
                                    </h2>
                                    <p class="simpl_p"><%= data.lat %>, <%= data.lon %></p>
                                </div>
                                <a href="/" class="simpl_btn btn_sq btn_48" hvr="Search"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g xmlns="http://www.w3.org/2000/svg"><path d="M22,20.59l-4.69-4.69C18.37,14.55,19,12.85,19,11c0-4.42-3.58-8-8-8c-4.08,0-7.44,3.05-7.93,7h2.02C5.57,7.17,8.03,5,11,5 c3.31,0,6,2.69,6,6s-2.69,6-6,6c-2.42,0-4.5-1.44-5.45-3.5H3.4C4.45,16.69,7.46,19,11,19c1.85,0,3.55-0.63,4.9-1.69L20.59,22 L22,20.59z"/><polygon points="8.43,9.69 9.65,15 11.29,15 12.55,11.22 13.5,13.5 15.5,13.5 15.5,12 14.5,12 13.25,9 11.71,9 10.59,12.37 9.35,7 7.7,7 6.45,11 1,11 1,12.5 7.55,12.5"/></g></svg></a>
                            </div>
                        </div>
                    </div>
                    <div class="box transparent_box" style="overflow:visible;">
                        <div class="box_content flex">
                            <div class="temperature_box flex">
                                <div class="main_temp">
                                <h1><%= data.current.temperature %></h1>
                                </div>
                                <div class="main_temp_scales">
                                    <div class="main_temp_overlay"></div>
                                    <div class="main_temp_scale"><%= data.current.temperature_unit %></div>
                                    <div class="main_temp_scale "><%= data.current.weather.desc %></div>
                                </div>
                            </div>
                            <div class="weather_icon" title="<%= data.current.weather.desc %>">
                                <img src="https://openweathermap.org/img/wn/<%= data.current.weather.icon %>@2x.png" alt="<%= data.current.weather.desc %>">
                            </div>
                        </div>
                        <div class="box_content" style="margin-top:-12px;">
                            <p class="simpl_p">
                                <%= data.current.temperature_min %> / <%= data.current.temperature_max %><%= data.current.temperature_unit %> &bullet; Feels like <%= data.current.apparent_temperature %><%= data.current.temperature_unit %>
                            </p>
                        </div>
                        <div class="flex">
                            <button class="simpl_btn btn_sq btn_opt hvr" id="gps_button" hvr="GPS">
                                <svg xmlns="http://www.w3.org/2000/svg" height="22px" viewBox="0 0 24 24" width="22px" style="padding:1px;"><path xmlns="http://www.w3.org/2000/svg" d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"/></svg>
                            </button>
                            <% if(data.current.dark_theme) {%>
                                <button class="simpl_btn btn_sq btn_opt hvr" id="toggle_theme_button" hvr="Dark theme">
                                    <svg xmlns="http://www.w3.org/2000/svg" height="22px" viewBox="0 0 24 24" width="22px" style="padding:1px;"><path id="path_theme" xmlns="http://www.w3.org/2000/svg" d="M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6z"/></svg>
                                </button>
                            <% } else { %>
                                <button class="simpl_btn btn_sq btn_opt hvr" id="toggle_theme_button" hvr="Light theme">
                                    <svg xmlns="http://www.w3.org/2000/svg" height="22px" viewBox="0 0 24 24" width="22px" style="padding:1px;"><path id="path_theme" xmlns="http://www.w3.org/2000/svg" d="M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"/></svg>
                                </button>
                            <% } %>
                            <button class="simpl_btn btn_sq btn_opt hvr" id="add_label" hvr="Add to speed list">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path xmlns="http://www.w3.org/2000/svg" d="M15 19H3l4.5-7L3 5h12c.65 0 1.26.31 1.63.84L21 12l-4.37 6.16c-.37.52-.98.84-1.63.84zm-8.5-2H15l3.5-5L15 7H6.5l3.5 5-3.5 5z"/></svg>
                            </button>
                            <a class="simpl_btn btn_sq btn_opt hvr" href="https://github.com/itsyeshu/weather-app/" target="_blank" hvr="Embed iframe">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path xmlns="http://www.w3.org/2000/svg" d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/></svg>
                            </a>
                        </div>
                    </div>
                    <div class="box transparent_box">
                        <div class="box_content">
                            <div class="small_boxes flex">
                                <div class="small_box">
                                    <div class="box_content">
                                        <p class="light_opacity">
                                            Wind speed
                                        </p>
                                        <p style="font-size:15px;line-height: 18px;margin-top:-6px;">
                                            <%= data.current.others.wind_speed %> <%= data.current.others.wind_speed_unit %> &bull; <%= data.current.others.wind_direction %><%= data.current.others.wind_direction_unit %>
                                        </p>
                                    </div>
                                </div>
                                <div class="small_box">
                                    <div class="box_content">
                                        <p class="light_opacity">
                                            UV index
                                        </p>
                                        <p style="font-size:15px;line-height: 18px;margin-top:-6px;">
                                            <%= data.current.others.uv_index %> (<%= data.current.others.uv_index_safety %>)
                                        </p>
                                    </div>
                                </div>
                                <div class="small_box">
                                    <div class="box_content">
                                        <p class="light_opacity">
                                            Air quality index
                                        </p>
                                        <p style="font-size:15px;line-height: 18px;margin-top:-6px;">
                                            <%= data.current.others.air_quality %> (<%= data.current.others.air_quality_safety %>)
                                        </p>
                                    </div>
                                </div>
                                <div class="small_box">
                                    <div class="box_content">
                                        <p class="light_opacity">
                                            Data provided by
                                        </p>
                                        <p style="font-size:15px;line-height: 18px;margin-top:-6px;">
                                            <a class="special_link" href="https://open-meteo.com/" target="_blank">Open-meteo <span class="svg-inline"><svg xmlns="http://www.w3.org/2000/svg" height="16" viewBox="0 96 960 960" width="16" fill="currentColor"><path d="M220 903q-27.637 0-47.319-19.681Q153 863.638 153 836V316q0-27.638 19.681-47.319Q192.363 249 220 249h257v67H220v520h520V579h67v257q0 27.638-19.681 47.319T740 903H220Zm168.5-188L341 667.5 692.5 316H568v-67h239v239h-67V363.5L388.5 715Z"/></svg></span></a>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box_border"></div>
                <div id="weather_forecast">
                    <div class="box">
                        <div class="box_content">
                            <p class="main_temp_scale light">
                                Hourly forecast
                            </p>
                            <div class="hourly_forecasts flex wide_scroll_box scroll-y">
                                <% for( let index = 0; index < data.hourly.forecast.time.length; index++ ) { %>
                                    <% if (data.hourly.forecast.time[index] == "01 AM" && index != 0) { %>
                                        <div class="hourly_forecast">
                                            &bullet;
                                        </div>
                                        <div class="hourly_forecast" style="white-space: nowrap;">
                                            Tomorrow
                                        </div>
                                    <% } %>
                                    <div class="hourly_forecast">
                                        <div class="normal_text">
                                            <%= data.hourly.forecast.time[index] %>
                                        </div>
                                        <div class="weather_icon small round" title="<%= data.hourly.forecast.weathercode[index].desc %>">
                                            <img src="https://openweathermap.org/img/wn/<%= data.hourly.forecast.weathercode[index].icon %>@2x.png" alt="<%= data.hourly.forecast.weathercode[index].desc %>">
                                        </div>
                                        <div class="normal_text">
                                            <%= data.hourly.forecast.temperature_2m[index] %>
                                            <%= data.current.temperature_unit %>
                                        </div>
                                    </div>
                                <% } %>
                            </div>
                        </div>
                    </div>
                    <div class="box">
                        <div class="box_container">
                            <div class="box_content">
                                <p class="main_temp_scale light">Forecast</p>
                                <div class="daily_forecasts">
                                    <% for(var index=0; index < 7; index++) { %>
                                        <% if(index != 0){ %>
                                            <hr class="hr">
                                        <% } %>
                                        <div class="daily_forecast flex">
                                            <div class="weather_icon small round" title="<%= data.daily.forecast.weathercode[index].desc %>">
                                                <img src="https://openweathermap.org/img/wn/<%= data.daily.forecast.weathercode[index].icon %>@2x.png" alt="<%= data.daily.forecast.weathercode[index].desc %>">
                                            </div>
                                            <div class="daily_forecast_date">
                                                <div class="main_temp_scale">
                                                    <%= data.daily.forecast.day[index] %> &bullet; <%= data.daily.forecast.time[index] %>
                                                </div>
                                                <div class="light_opacity">
                                                    <%= data.daily.forecast.weathercode[index].desc %>
                                                </div>
                                            </div>
                                            <div class="text_align_rt">
                                                <div class="simpl_text">
                                                    <%= data.daily.forecast.temperature_2m_min[index] %> / <%= data.daily.forecast.temperature_2m_max[index] %>°C
                                                </div>
                                            </div>
                                        </div>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="dialog-container">
                <dialog id="gps_info_dialog" class="dialog">
                    <div class="dialog-sect dialog-title-sect">
                        <img src="/public/img/loading-transparent.gif" alt="" style="display:inline-block;width:34px;height:34px;vertical-align: middle;margin:0 0 -4px -8px;">
                        <div class="dialog-title">
                            Under development
                        </div>
                    </div>
                    <div class="dialog-sect dialog-body">
                        <p>Sorry for inconvenience, this functionality will be added shortly.</p>
                    </div>
                    <div class="dialog-sect dialog-footer">
                        <button class="simpl_btn btn" onclick="this.parentNode.parentNode.close();">Close</button>
                    </div>
                </dialog>
            </div>
        </div>
    </main>
    <script type="text/javascript" src="/public/js/script.js"></script>
</body>
</html>